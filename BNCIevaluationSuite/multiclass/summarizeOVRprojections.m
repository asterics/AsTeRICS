c1=dataTrain(1,1);
c2=dataTrain(1,2);
c3=dataTrain(1,3);
c4=dataTrain(1,4);
figure
subplot(4,4,1)
imagesc(permute(var(c1.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,2)
imagesc(permute(var(c1.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,3)
imagesc(permute(var(c1.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,4)
imagesc(permute(var(c1.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,5)
imagesc(permute(var(c2.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,6)
imagesc(permute(var(c2.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,7)
imagesc(permute(var(c2.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,8)
imagesc(permute(var(c2.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,9)
imagesc(permute(var(c3.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,10)
imagesc(permute(var(c3.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,11)
imagesc(permute(var(c3.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,12)
imagesc(permute(var(c3.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,13)
imagesc(permute(var(c4.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,14)
imagesc(permute(var(c4.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,15)
imagesc(permute(var(c4.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,16)
imagesc(permute(var(c4.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,1)
ylabel('class 1 space')
title('trials class 1')
subplot(4,4,2)
title('trials class 2')
subplot(4,4,3)
title('trials class 3')
subplot(4,4,4)
title('trials class 4')
subplot(4,4,5)
ylabel('class 2 space')
subplot(4,4,9)
ylabel('class 3 space')
subplot(4,4,13)
ylabel('class 4 space')

c1=dataTest(1,1);
c2=dataTest(1,2);
c3=dataTest(1,3);
c4=dataTest(1,4);
figure
subplot(4,4,1)
imagesc(permute(var(c1.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,2)
imagesc(permute(var(c1.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,3)
imagesc(permute(var(c1.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,4)
imagesc(permute(var(c1.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,5)
imagesc(permute(var(c2.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,6)
imagesc(permute(var(c2.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,7)
imagesc(permute(var(c2.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,8)
imagesc(permute(var(c2.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,9)
imagesc(permute(var(c3.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,10)
imagesc(permute(var(c3.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,11)
imagesc(permute(var(c3.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,12)
imagesc(permute(var(c3.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,13)
imagesc(permute(var(c4.features(:,:,c1.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,14)
imagesc(permute(var(c4.features(:,:,c2.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,15)
imagesc(permute(var(c4.features(:,:,c3.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,16)
imagesc(permute(var(c4.features(:,:,c4.GT==1),0,2),[1,3,2]),[0,3e-5])
subplot(4,4,1)
ylabel('class 1 space')
title('trials class 1')
subplot(4,4,2)
title('trials class 2')
subplot(4,4,3)
title('trials class 3')
subplot(4,4,4)
title('trials class 4')
subplot(4,4,5)
ylabel('class 2 space')
subplot(4,4,9)
ylabel('class 3 space')
subplot(4,4,13)
ylabel('class 4 space')